values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3.5,1.5,0.5), "cm")
)
ggsave("neutral_nato_xtab.png", height=7, width=13.5, dpi=300, device="png")
ggplot(rand2.p22, aes(p22, prop, fill=rand2))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=rand2.p22,
aes(x=p22,y=prop,label=ifelse(prop > 0.015, sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3.5,2,0.5), "cm")
)
ggplot(rand2.p22, aes(p22, prop, fill=rand2))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=rand2.p22,
aes(x=p22,y=prop,label=ifelse(prop > 0.015, sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,4,2,0.5), "cm")
)
ggsave("neutral_nato_xtab.png", height=7, width=13.5, dpi=300, device="png")
ggplot(rand2.p22, aes(p22, prop, fill=rand2))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=rand2.p22,
aes(x=p22,y=prop,label=ifelse(prop > 0.015, sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,5,1.5,0.5), "cm")
)
ggsave("neutral_nato_xtab.png", height=7, width=13.5, dpi=300, device="png")
ggplot(rand2.p22, aes(p22, prop, fill=rand2))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=rand2.p22,
aes(x=p22,y=prop,label=ifelse(prop > 0.015, sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,5.5,1,0.5), "cm")
)
ggsave("neutral_nato_xtab.png", height=7, width=13.5, dpi=300, device="png")
ggplot(rand2.p22, aes(p22, prop, fill=rand2))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=rand2.p22,
aes(x=p22,y=prop,label=ifelse(prop > 0.015, sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
labs(title="Alignment with a bloc vs. neutrality \nBy support of membership in NATO",
subtitle="Caucasus Barometer, 2017")+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,6,1,0.5), "cm")
)
ggsave("neutral_nato_xtab.png", height=7, width=13.5, dpi=300, device="png")
p22.m1 <- as.data.frame(svytable(~p22+m1, cb2017ges), drop.unused.levels = TRUE) %>%
subset(., !p22 %in% c("Break off", "Legal skip", "Interviewer error") & !m1 %in% c("Break off", "Legal skip", "Interviewer error")) %>%
group_by(m1) %>%
mutate(prop=Freq/sum(Freq))
View(p22.m1)
p22.m1 <- as.data.frame(svytable(~p22+m1, cb2017ges), drop.unused.levels = TRUE) %>%
subset(., !p22 %in% c("Break off", "Legal skip", "Interviewer error") &
!m1 %in% c("Refuse to answer", "Break off", "Legal skip", "Interviewer error")) %>%
group_by(m1) %>%
mutate(prop=Freq/sum(Freq))
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999","#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "vertical")
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "vertical")
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,6,1,0.5), "cm")
)
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,5,1,0.5), "cm")
)
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#d6d6d6","#a6611a","#dfc27d","#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,4,1,0.5), "cm")
)
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,4,1,0.5), "cm")
)
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
labs(title="Support of Georgia's membership in NATO \nBy the attitudes towards migrants",
subtitle="Caucasus Barometer, 2017")+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,4,1,0.5), "cm")
)
ggplot(p22.m1, aes(m1, prop, fill=p22))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p22.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
labs(title="Support of Georgia's membership in NATO \nBy the attitudes towards migrants",
subtitle="Caucasus Barometer, 2017")+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3,1,0.5), "cm")
)
ggsave("nato_migrants_xtab.png", height=7, width=13.5, dpi=300, device="png")
p25.m1 <- as.data.frame(svytable(~p25+m1, cb2017ges), drop.unused.levels = TRUE) %>%
subset(., !p25 %in% c("Break off", "Legal skip", "Interviewer error") &
!m1 %in% c("Refuse to answer", "Break off", "Legal skip", "Interviewer error")) %>%
group_by(m1) %>%
mutate(prop=Freq/sum(Freq))
ggplot(p25.m1, aes(m1, prop, fill=p25))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p25.m1,
aes(x=m1,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
labs(title="Support of Georgia's membership in the EU \nBy the attitudes towards migrants",
subtitle="Caucasus Barometer, 2017")+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3,1,0.5), "cm")
)
ggsave("eu_migrants_xtab.png", height=7, width=13.5, dpi=300, device="png")
p25.p13 <- as.data.frame(svytable(~p25+p13, cb2017ges), drop.unused.levels = TRUE) %>%
subset(., !p25 %in% c("Break off", "Legal skip", "Interviewer error") &
!p13 %in% c("Break off", "Legal skip", "Interviewer error")) %>%
group_by(p13) %>%
mutate(prop=Freq/sum(Freq))
ggplot(p25.p13, aes(p13, prop, fill=p25))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p25.p13,
aes(x=p13,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
labs(title="Support of Georgia's membership in the EU \nBy the attitudes towards migrants",
subtitle="Caucasus Barometer, 2017")+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3,1,0.5), "cm")
)
p28_geo.p13 <- as.data.frame(svytable(~p28_geo+p13, cb2017ges), drop.unused.levels = TRUE) %>%
subset(., !p28_geo %in% c("Break off", "Legal skip", "Interviewer error") &
!p13 %in% c("Break off", "Legal skip", "Interviewer error")) %>%
group_by(p13) %>%
mutate(prop=Freq/sum(Freq))
ggplot(p28_geo.p13, aes(p13, prop, fill=p28_geo))+
geom_bar(stat="identity", position="stack")+
coord_flip()+
guides(fill = guide_legend(reverse=T))+
geom_text(data=p28_geo.p13,
aes(x=p13,y=prop,label=ifelse(prop > 0.015,
sprintf("%0.f", round(prop*100, digits = 0)), "")),
position = position_stack(vjust=0.5),
family="Futura Hv BT")+
scale_fill_manual(name="კატეგორია",
values=c("#999999", "#444444", "#a6611a","#dfc27d","#d6d6d6", "#80cdc1", "#018571"))+
scale_y_continuous(labels=function(x)x*100, limits=c(0, 1))+
labs(title="Support of Georgia's membership in the EU \nBy the attitudes towards migrants",
subtitle="Caucasus Barometer, 2017")+
theme_plot+
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
# axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
legend.text.align = 0,
legend.title = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0.5,3,1,0.5), "cm")
)
